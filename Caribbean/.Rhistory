plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = fiji_temp_colors_transp, breaks = cuts,  main = paste('Slow Coral: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(viridis(5)),pch=20, cex = 0.5)
}
test <- lapply(fiji_forecast_sp1_45, function(x) rowMeans(x[,72:82]))
test.df <- as.data.frame(test)
test2.df <- byapply(test.df, 5, rowMeans)
test_list <-  list()
for (i in 1:9) {
test_list[[i]] <- data.frame(treml_connectivity_fiji_df$reefID, treml_connectivity_fiji_df$lat, treml_connectivity_fiji_df$long, test2.df[,i])
}
spdf_list <- list()
for (i in 1:9){
spdf_list[[i]] <- SpatialPointsDataFrame(coords = end_of_hindcast_fiji_sp1_coords, data = test_list[[i]] , proj4string = CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))
}
#layout(mat = layout.matrix,
#   heights = c(1, 1, 1),    # Heights of the two rows
#   widths = c(1, 1,1))     # Widths of the two columns
#par(mfrow=c(3,3)) # dimensions of panels
#par(mar=c(4,4,4,4)) # margins of each plot panel
#par(oma = c(0, 0, 0, 0)) # outer margins
for (i in 1:9){
spdf_list[[i]]$color <- viridis(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
# plot(Delta_Fiji_HadISSTAndRCP4.5[[1920]], col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = fiji_temp_colors_transp, breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(viridis(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- viridis(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
# plot(Delta_Fiji_HadISSTAndRCP4.5[[1920]], col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(viridis(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- viridis(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
# plot(Delta_Fiji_HadISSTAndRCP4.5[[1920]], col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(viridis(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- bgyoPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
# plot(Delta_Fiji_HadISSTAndRCP4.5[[1920]], col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- bgyoPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
# plot(Delta_Fiji_HadISSTAndRCP4.5[[1920]], col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 1, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- bgyoPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
# plot(Delta_Fiji_HadISSTAndRCP4.5[[1920]], col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 1, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- bgyoPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
# plot(Delta_Fiji_HadISSTAndRCP4.5[[1920]], col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 1, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- bgyoPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- bgyoPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 8:8){
spdf_list[[i]]$color <- bgyoPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 8:8){
spdf_list[[i]]$color <- byapPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 8:8){
spdf_list[[i]]$color <- bbprPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
for (i in 9:9){
spdf_list[[i]]$color <- bbprPal(5)[as.numeric(cut(test_list[[i]]$test2.df...i.,breaks = seq(0, 0.5, length.out = 6)))]
plot(calc(Delta_Fiji_HadISSTAndRCP4.5[[2640:2760]], mean), col = "white", breaks = cuts,  main = paste('Coral 1, RCP 4.5: avg. abundance 2008-2018 at sites'))
plot(rasterToPolygons(Delta_Fiji_HadISSTAndRCP4.5), border='gray3', lwd=0.1, add = TRUE)
plot(Fiji_MillenniumCoralMapAC, col = "white", border = "black", lwd = 0.1, add = TRUE)
points(end_of_hindcast_sp1_45.spdf, cex = 0.8, col = spdf_list[[i]]$color, pch = 20)
legend("topleft",title="Absolute Cover",legend=rev(c("<0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4", ">0.4")),col =rev(bgyoPal(5)),pch=20, cex = 0.5)
}
View(Schill_connectivity_pts_WGS84_df_unique)
plot(Schill_coords_unique)
View(Schill_coords_unique)
View(Schill_connectivity_pts_WGS84_df_unique)
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique)
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique, text(Schill_connectivity_pts_WGS84_spdf_adjust_unique$FromReef))
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique)
text(Schill_connectivity_pts_WGS84_spdf_adjust_unique$FromReef)
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique)
with(Schill_connectivity_pts_WGS84_spdf_unique, text(Schill_connectivity_pts_WGS84_df_unique, labels = Schill_connectivity_pts_WGS84_df_unique$FromReef, pos = 4))
with(Schill_connectivity_pts_WGS84_spdf_adjust_unique, text(Schill_connectivity_pts_WGS84_df_unique, labels = Schill_connectivity_pts_WGS84_df_unique$FromReef, pos = 4))
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique)
with(Schill_connectivity_pts_WGS84_spdf_adjust_unique, text(Schill_connectivity_pts_WGS84_df_unique, labels = Schill_connectivity_pts_WGS84_df_unique$FromReef, pos = 4))
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique)
with(Schill_connectivity_pts_WGS84_spdf_adjust_unique, text(Schill_connectivity_pts_WGS84_spdf_adjust_unique, labels = Schill_connectivity_pts_WGS84_df_unique$FromReef, pos = 4))
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique)
with(Schill_connectivity_pts_WGS84_spdf_adjust_unique, text(Schill_connectivity_pts_WGS84_spdf_adjust_unique, labels = Schill_connectivity_pts_WGS84_df_unique$FromReef, pos = 1))
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique)
with(Schill_connectivity_pts_WGS84_spdf_adjust_unique, text(Schill_connectivity_pts_WGS84_spdf_adjust_unique, labels = Schill_connectivity_pts_WGS84_df_unique$FromReef, cex = 0.3, pos = 1))
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique)
with(Schill_connectivity_pts_WGS84_spdf_adjust_unique, text(Schill_connectivity_pts_WGS84_spdf_adjust_unique, labels = Schill_connectivity_pts_WGS84_df_unique$FromReef, cex = 0.3, pos = 2))
plot(Schill_connectivity_pts_WGS84_spdf_adjust_unique, cex = 0.1)
with(Schill_connectivity_pts_WGS84_spdf_adjust_unique, text(Schill_connectivity_pts_WGS84_spdf_adjust_unique, labels = Schill_connectivity_pts_WGS84_df_unique$FromReef, cex = 0.3, pos = 2))
save(Caribbean_HadISST_sst_shifted, file ='Caribbean_HadISST_sst_shifted.R')
save(Caribbean_mean_OISST_ltm, file ='Caribbean_mean_OISST_ltm.R')
save(Caribbean_GISS_hist_and_rcp45_1850to2300,file = "Caribbean_GISS_hist_and_rcp45_1850to2300.R")
save(Caribbean_GISS_hist_and_rcp85_1850to2300,file = "Caribbean_GISS_hist_and_rcp85_1850to2300.R")
save(mean_Caribbean_GISS_E2_H_RCP4.5, 'mean_Caribbean_GISS_E2_H_RCP4.5.R')
save(mean_Caribbean_GISS_E2_H_RCP4.5, file = 'mean_Caribbean_GISS_E2_H_RCP4.5.R')
mean_Caribbean_GISS_E2_H_RCP8.5 <- calc(Caribbean_GISS_E2_H_RCP8.5, meam)
mean_Caribbean_GISS_E2_H_RCP8.5 <- calc(Caribbean_GISS_E2_H_RCP8.5, mean)
save(mean_Caribbean_GISS_E2_H_RCP8.5, file = 'mean_Caribbean_GISS_E2_H_RCP8.5.R')
getwd()
save(Indonesia_mean_OISST_ltm, file = 'Indonesia_mean_OISST_ltm.R')
save(Indonesia_GISS_hist_and_rcp45_1850to2300, file = 'Indonesia_GISS_hist_and_rcp45_1850to2300.R')
save(Indonesia_GISS_hist_and_rcp85_1850to2300, file = 'Indonesia_GISS_hist_and_rcp85_1850to2300.R')
save(Indonesia_HadISST_sst, file = 'Indonesia_HadISST_sst.R')
View(Schill_coords_unique)
View(Schill_connectivity_pts_WGS84_df_unique)
MBRS_site_ids <- c(179, 187, 199, 206, 207, 219, 224, 233, 246, 252, 269, 275, 292, 289, 291, 293, 297, 300, 303, 306, 307, 308, 309, 310,311,312)
Schill_connectivity_pts_WGS84_df_unique$FromReef[MBRS_site_ids]
Schill_connectivity_pts_WGS84_df_unique[Schill_connectivity_pts_WGS84_df_unique[,'FromReef'= MBRS_site_ids,]]
Schill_connectivity_pts_WGS84_df_unique[Schill_connectivity_pts_WGS84_df_unique[,'FromReef'] = MBRS_site_ids,]
Schill_connectivity_pts_WGS84_df_unique[Schill_connectivity_pts_WGS84_df_unique[,'FromReef'] == MBRS_site_ids,]
Schill_connectivity_pts_WGS84_df_unique[Schill_connectivity_pts_WGS84_df_unique[,'FromReef'] %in% MBRS_site_ids,]
MBRS_df <- Schill_connectivity_pts_WGS84_df_unique[Schill_connectivity_pts_WGS84_df_unique[,'FromReef'] %in% MBRS_site_ids,]
MBRS_coords <- data.frame(MBRS_df$coords.x1, MBRS_df$coords.x2)
rm(Delta_Caribbean_HadISST_sst)
rm(Delta_Fiji_HadISSTAndRCP4.5)
rm(Delta_Fiji_HadISSTAndRCP8.5)
getwd()
setwd("~/Documents/SST_data/SST_data_files")
load('Delta_Caribbean_HadISSTAndRCP4.5.R')
load('Delta_Caribbean_HadISSTAndRCP8.5.R')
MBRS_spdf <- SpatialPointsDataFrame(coords = MBRS_coords, data = MBRS_df, proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
Delta_MBRS_HadISSTAndRCP4.5_atsites <- data.frame(MBRS_coords, MBRS_df$reefID, extract(Delta_Caribbean_HadISSTAndRCP4.5, MBRS_spdf))
View(Caribbean_SST_HadISSTAndRCP8.5_atsites)
extract(Delta_Caribbean_HadISSTAndRCP4.5, MBRS_spdf)
dims(extract(Delta_Caribbean_HadISSTAndRCP4.5, MBRS_spdf))
dim(extract(Delta_Caribbean_HadISSTAndRCP4.5, MBRS_spdf))
Delta_MBRS_HadISSTAndRCP4.5_atsites <- data.frame(MBRS_coords, MBRS_site_ids, extract(Delta_Caribbean_HadISSTAndRCP4.5, MBRS_spdf))
Delta_MBRS_HadISSTAndRCP8.5_atsites <- data.frame(MBRS_coords, MBRS_site_ids, extract(Delta_Caribbean_HadISSTAndRCP8.5, MBRS_spdf))
extent(Delta_Caribbean_HadISSTAndRCP4.5)
MBRS_coords
MBRS_coords$MBRS_df.coords.x1 <- MBRS_coords$MBRS_df.coords.x1+360
Delta_MBRS_HadISSTAndRCP4.5_atsites <- data.frame(MBRS_coords, MBRS_site_ids, extract(Delta_Caribbean_HadISSTAndRCP4.5, MBRS_spdf))
Delta_MBRS_HadISSTAndRCP8.5_atsites <- data.frame(MBRS_coords, MBRS_site_ids, extract(Delta_Caribbean_HadISSTAndRCP8.5, MBRS_spdf))
MBRS_spdf <- SpatialPointsDataFrame(coords = MBRS_coords, data = MBRS_df, proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
Delta_MBRS_HadISSTAndRCP4.5_atsites <- data.frame(MBRS_coords, MBRS_site_ids, extract(Delta_Caribbean_HadISSTAndRCP4.5, MBRS_spdf))
Delta_MBRS_HadISSTAndRCP8.5_atsites <- data.frame(MBRS_coords, MBRS_site_ids, extract(Delta_Caribbean_HadISSTAndRCP8.5, MBRS_spdf))
Delta_MBRS_HadISSTAndRCP4.5_atsites[[1]]
Delta_Caribbean_HadISSTAndRCP4.5_atsites[[1]]
Delta_MBRS_HadISSTAndRCP4.5_atsites[[2]]
dim(Delta_MBRS_HadISSTAndRCP4.5_atsites)
Delta_MBRS_HadISSTAndRCP4.5_atsites_formatrix <- Delta_MBRS_HadISSTAndRCP4.5_atsites_formatrix[,-c(1,2)]
Delta_MBRS_HadISSTAndRCP4.5_atsites_formatrix <- Delta_MBRS_HadISSTAndRCP4.5_atsites[,-c(1,2)]
Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix <- as.matrix(Delta_MBRS_HadISSTAndRCP4.5_atsites_formatrix)
Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix <- IfNAReplace(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix)
Delta_MBRS_HadISSTAndRCP8.5_atsites_formatrix <- Delta_MBRS_HadISSTAndRCP8.5_atsites[,-c(1,2)]
Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix <- as.matrix(Delta_MBRS_HadISSTAndRCP8.5_atsites_formatrix)
Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix <- IfNAReplace(Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix)
plot(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,-c(1)])
plot(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,-c(1)])
plot(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,-c(1,2)])
plot(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,-c(1,2)])
Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,c(1,2)]
Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[2,c(1,2)]
Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,c(1,10)]
Delta_MBRS_HadISSTAndRCP4.5_atsites[1]
Delta_MBRS_HadISSTAndRCP4.5_atsites[2]
Delta_MBRS_HadISSTAndRCP4.5_atsites[3]
Delta_MBRS_HadISSTAndRCP4.5_atsites[1]
Delta_MBRS_HadISSTAndRCP4.5_atsites[2]
Delta_MBRS_HadISSTAndRCP4.5_atsites[3]
Delta_MBRS_HadISSTAndRCP4.5_atsites[4]
Delta_MBRS_HadISSTAndRCP4.5_atsites_formatrix <- Delta_MBRS_HadISSTAndRCP4.5_atsites[Delta,-c(1,2,3)]
Delta_MBRS_HadISSTAndRCP4.5_atsites_formatrix <- Delta_MBRS_HadISSTAndRCP4.5_atsites[,-c(1,2,3)]
Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix <- as.matrix(Delta_MBRS_HadISSTAndRCP4.5_atsites_formatrix)
Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix <- IfNAReplace(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix)
Delta_MBRS_HadISSTAndRCP8.5_atsites_formatrix <- Delta_MBRS_HadISSTAndRCP8.5_atsites[,-c(1,2,3)]
Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix <- as.matrix(Delta_MBRS_HadISSTAndRCP8.5_atsites_formatrix)
Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix <- IfNAReplace(Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix)
plot(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,])
plot(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,])
plot(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix[1,])
plot(Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix[1,])
write.csv(Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix, file = 'MBRS_HadISSTAndRCP4.5_atsites_matrix.csv')
write.csv(Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix, file = 'MBRS_HadISSTAndRCP8.5_atsites_matrix.csv')
View(MBRS_df)
View(Indonesia_GISS_hist_and_rcp45_1850to2300)
save(treml_coords, "swp_coords.R")
save("swp_coords.R", treml_coords)
save(file = "swp_coords.R", treml_coords)
save(file = "swp_reef_ID.R", treml_connectivity_df$reefID)
swp_reef_ID <- treml_connectivity_df$reefID
save(file = "swp_reef_ID.R", swp_reef_ID )
save(file = "caribbean_coords.R", Schill_coords_unique )
caribbean_reef_ID <- Schill_connectivity_pts_WGS84_df_unique$FromReef
save(file = "caribbean_reef_ID.R", caribbean_reef_ID)
save(file = "CT_coords.R", indonesia_coords )
CT_reef_ID <- indonesia_sites$site_id
save(file = "CT_reef_ID.R", CT_reef_ID )
plot(mean_OISST_ltm)
load("~/Documents/SST_data/SST_data_files/generic_SST_formatting.RData")
Caribbean_extent <- extent(c(260, 310, 0, 50))
Caribbean_coarse_rcp45 <- crop(coarse_rcp45, Caribbean_extent)
Caribbean_coarse_rcp85 <- crop(coarse_rcp85, Caribbean_extent)
Caribbean_mean_OISST_ltm <- crop(mean_OISST_ltm, Caribbean_extent)
View(mean_OISST_ltm)
OISST_ltm <- brick(file.choose(""), values = TRUE, varname = "sst")
mean_OISST_ltm <- calc(OISST_ltm, mean)
Caribbean_mean_OISST_ltm <- crop(mean_OISST_ltm, Caribbean_extent)
Caribbean_HadISST_sst <- brick("Caribbean_HadISST_sst.nc", values = TRUE, varname = "sst")
#Caribbean_HadISST_sst <- brick("Caribbean_HadISST_sst.nc", values = TRUE, varname = "sst")
Caribbean_HadISST_sst <- crop(HadISST_sst, Caribbean_extent)
#Caribbean_HadISST_sst <- brick("Caribbean_HadISST_sst.nc", values = TRUE, varname = "sst")
#Caribbean_HadISST_sst <- crop(HadISST_sst, Caribbean_extent)
Caribbean_HadISST_sst <- brick(file.choose(), values = TRUE, varname = "sst")
mean_Caribbean_coarse_rcp45_1982to2010 <- calc(subset(Caribbean_coarse_rcp45,1584:1944), mean)
anoms_Caribbean_coarse_rcp45_1850to2300 <- Caribbean_coarse_rcp45_1850to2300 - mean_Caribbean_coarse_rcp45_1982to2010
mean_Caribbean_coarse_rcp45_1982to2010 <- calc(subset(Caribbean_coarse_rcp45,1584:1944), mean)
anoms_Caribbean_coarse_rcp45_1850to2300 <- Caribbean_coarse_rcp45 - mean_Caribbean_coarse_rcp45_1982to2010
anoms_Caribbean_coarse_rcp45_1850to2300_0.25 <- resample(anoms_Caribbean_coarse_rcp45_1850to2300, Caribbean_mean_OISST_ltm, method = 'bilinear')
Delta_Caribbean_HisttoRCP4.5 <- Caribbean_mean_OISST_ltm + anoms_Caribbean_coarse_rcp45_1850to2300_0.25
mean_Caribbean_coarse_rcp85_1982to2010 <- calc(subset(Caribbean_coarse_rcp85,1584:1944), mean)
anoms_Caribbean_coarse_rcp85_1850to2300 <- Caribbean_coarse_rcp85 - mean_Caribbean_coarse_rcp85_1982to2010
anoms_Caribbean_coarse_rcp85_1850to2300_0.25 <- resample(anoms_Caribbean_coarse_rcp85_1850to2300, Caribbean_mean_OISST_ltm, method = 'bilinear')
Delta_Caribbean_HisttoRCP8.5 <- Caribbean_mean_OISST_ltm + anoms_Caribbean_coarse_rcp85_1850to2300_0.25
mean_Caribbean_HadISST_sst_1982to2018 <- calc(subset(Caribbean_HadISST_sst_shifted, 1344:1779), mean)
anoms_Caribbean_HadISST_sst <- Caribbean_HadISST_sst_shifted - mean_SWP_HadISST_sst_1982to2018
mean_Caribbean_HadISST_sst_1982to2018 <- calc(subset(Caribbean_HadISST_sst_shifted, 1344:1779), mean)
anoms_Caribbean_HadISST_sst <- Caribbean_HadISST_sst_shifted - mean_Caribbean_HadISST_sst_1982to2018
anoms_Caribbean_HadISST_sst_0.25 <- resample(anoms_Caribbean_HadISST_sst, Caribbean_mean_OISST_ltm, method = 'bilinear')
Delta_Caribbean_HadISST_sst <- Caribbean_mean_OISST_ltm + anoms_Caribbean_HadISST_sst_0.25
plot(Delta_Caribbean_HadISST_sst[[1]])
plot(cellStats(Delta_Caribbean_HadISST_sst, stat = 'mean'))
#SWP Hist and RCP8.5
Delta_Caribbean_coarse_RCP4.5_forbind <- dropLayer(Delta_Caribbean_HisttoRCP4.5, 1:2019)
Delta_Caribbean_HadISSTAndRCP4.5 <- stack(Delta_Caribbean_HadISST_sst, Delta_Caribbean_coarse_RCP4.5_forbind, value = TRUE)
#SWP Hist and RCP8.5
Delta_Caribbean_coarse_RCP8.5_forbind <- dropLayer(Delta_Caribbean_HisttoRCP8.5, 1:2019)
Delta_Caribbean_HadISSTAndRCP8.5 <- stack(Delta_Caribbean_HadISST_sst, Delta_Caribbean_coarse_RCP8.5_forbind, value = TRUE)
write.csv(Caribbean_SST_GISS_HistoRCP8.5_atsites_matrix, file = 'Caribbean_SST_GISS_HisttoRCP8.5_atsites_matrix_INM.csv')
write.csv(Caribbean_SST_GISS_HistoRCP4.5_atsites_matrix, file = 'Caribbean_SST_GISS_HisttoRCP4.5_atsites_matrix_INM.csv')
xy <- caribbean_coords[,c(1,2)]
spdf <- SpatialPointsDataFrame(coords = xy, data = caribbean_coords,
proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
Caribbean_HadISSTAndRCP4.5_atsites <- data.frame(caribbean_coords, caribbean_reef_ID, extract(Delta_Caribbean_HadISSTAndRCP4.5, spdf))
Caribbean_HadISSTAndRCP4.5_atsites_formatrix <- Caribbean_HadISSTAndRCP4.5_atsites[,-c(1,2)]
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- as.matrix(Caribbean_HadISSTAndRCP4.5_atsites_formatrix)
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP4.5_atsites_matrix)
Caribbean_HadISSTAndRCP8.5_atsites <- data.frame(caribbean_coords, caribbean_reef_ID, extract(Delta_Caribbean_HadISSTAndRCP8.5, spdf))
Caribbean_HadISSTAndRCP8.5_atsites_formatrix <- Caribbean_HadISSTAndRCP8.5_atsites[,-c(1,2)]
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- as.matrix(Caribbean_HadISSTAndRCP8.5_atsites_formatrix)
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP8.5_atsites_matrix)
plot(Caribbean_HadISSTAndRCP4.5_atsites_matrix[1,-c(1)])
plot(Caribbean_HadISSTAndRCP8.5_atsites_matrix[1,-c(1)])
plot(Delta_Caribbean_coarse_RCP8.5_forbind)
plot(Delta_Caribbean_coarse_RCP8.5_forbind[1,-c(1)])
plot(cellStats(Delta_Caribbean_coarse_RCP4.5, stat = 'mean')))
plot(cellStats(Delta_Caribbean_coarse_RCP4.5, stat = 'mean'))
plot(cellStats(Delta_Caribbean_HisttoRCP4.5, stat = 'mean'))
plot(cellStats(Delta_Caribbean_HisttoRCP4.5, stat = 'mean'))
plot(cellStats(Delta_Caribbean_coarse_RCP4.5_forbind, stat = 'mean'))
plot(cellStats(Delta_Caribbean_HisttoRCP4.5, stat = 'mean'))
plot(cellStats(Delta_Caribbean_coarse_RCP4.5_forbind, stat = 'mean'))
plot(cellStats(Delta_Caribbean_HadISSTAndRCP4.5, stat = 'mean'))
xy <- caribbean_coords[,c(1,2)]
spdf <- SpatialPointsDataFrame(coords = xy, data = caribbean_coords,
proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
Caribbean_HadISSTAndRCP4.5_atsites <- data.frame(caribbean_coords, caribbean_reef_ID, extract(Delta_Caribbean_HadISSTAndRCP4.5, spdf))
Caribbean_HadISSTAndRCP4.5_atsites_formatrix <- Caribbean_HadISSTAndRCP4.5_atsites[,-c(1,2)]
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- as.matrix(Caribbean_HadISSTAndRCP4.5_atsites_formatrix)
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP4.5_atsites_matrix)
Caribbean_HadISSTAndRCP8.5_atsites <- data.frame(caribbean_coords, caribbean_reef_ID, extract(Delta_Caribbean_HadISSTAndRCP8.5, spdf))
Caribbean_HadISSTAndRCP8.5_atsites_formatrix <- Caribbean_HadISSTAndRCP8.5_atsites[,-c(1,2)]
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- as.matrix(Caribbean_HadISSTAndRCP8.5_atsites_formatrix)
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP8.5_atsites_matrix)
plot(Caribbean_HadISSTAndRCP4.5_atsites_matrix[1,-c(1)])
plot(Caribbean_HadISSTAndRCP8.5_atsites_matrix[1,-c(1)])
View(Caribbean_SST_HadISSTAndRCP8.5_atsites_formatrix)
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP4.5_atsites_matrix)
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP8.5_atsites_matrix)
write.csv(Caribbean_HadISSTAndRCP8.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP8.5_atsites_matrix_INM.csv')
write.csv(Caribbean_HadISSTAndRCP4.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP4.5_atsites_matrix_INM.csv')
xy <- caribbean_coords[,c(1,2)]
spdf <- SpatialPointsDataFrame(coords = xy, data = caribbean_coords,
proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
Delta_Caribbean_HadISSTAndRCP4.5 <- setExtent(Delta_Caribbean_HadISSTAndRCP4.5, c(-100, -50, 0, 50))
Caribbean_HadISSTAndRCP4.5_atsites <- data.frame(caribbean_coords, caribbean_reef_ID, extract(Delta_Caribbean_HadISSTAndRCP4.5, spdf))
Caribbean_HadISSTAndRCP4.5_atsites_formatrix <- Caribbean_HadISSTAndRCP4.5_atsites[,-c(1,2)]
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- as.matrix(Caribbean_HadISSTAndRCP4.5_atsites_formatrix)
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP4.5_atsites_matrix)
Delta_Caribbean_HadISSTAndRCP8.5 <- setExtent(Delta_Caribbean_HadISSTAndRCP8.5, c(-100, -50, 0, 50))
Caribbean_HadISSTAndRCP8.5_atsites <- data.frame(caribbean_coords, caribbean_reef_ID, extract(Delta_Caribbean_HadISSTAndRCP8.5, spdf))
Caribbean_HadISSTAndRCP8.5_atsites_formatrix <- Caribbean_HadISSTAndRCP8.5_atsites[,-c(1,2)]
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- as.matrix(Caribbean_HadISSTAndRCP8.5_atsites_formatrix)
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP8.5_atsites_matrix)
plot(Caribbean_HadISSTAndRCP4.5_atsites_matrix[1,-c(1)])
plot(Caribbean_HadISSTAndRCP8.5_atsites_matrix[1,-c(1)])
write.csv(Caribbean_HadISSTAndRCP8.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP8.5_atsites_matrix_INM.csv')
write.csv(Caribbean_HadISSTAndRCP4.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP4.5_atsites_matrix_INM.csv')
rm(Delta_Caribbean_coarse_RCP4.5_forbind, Delta_Caribbean_coarse_RCP8.5_forbind, Delta_Caribbean_HadISST_sst, Delta_Caribbean_HadISSTAndRCP4.5, Delta_Caribbean_HadISSTAndRCP8.5, Delta_Caribbean_HisttoRCP4.5, Delta_Caribbean_HisttoRCP8.5)
rm(Delta_MBRS_HadISSTAndRCP4.5_atsites, Delta_MBRS_HadISSTAndRCP4.5_atsites_formatrix, Delta_MBRS_HadISSTAndRCP4.5_atsites_matrix, Delta_MBRS_HadISSTAndRCP8.5_atsites, Delta_MBRS_HadISSTAndRCP8.5_atsites_formatrix, Delta_MBRS_HadISSTAndRCP8.5_atsites_matrix)
rm(Caribbean_coarse_rcp45, Caribbean_coarse_rcp85, Caribbean_extent, Caribbean_GISS_E2_H_RCP4.5, Caribbean_GISS_E2_H_RCP8.5, Caribbean_GISS_hist_and_rcp45_1850to2300, Caribbean_GISS_hist_and_rcp85_1850to2300)
rm(Caribbean_HadISST_sst)
rm(Caribbean_SST_GISS_HistoRCP4.5_atsites_matrix)
rm(Caribbean_SST_HadISSTAndRCP4.5_atsites)
rm(Caribbean_HadISSTAndRCP4.5_atsites)
rm(Caribbean_HadISSTAndRCP4.5_atsites_formatrix)
rm(Caribbean_HadISSTAndRCP4.5_atsites_matrix)
rm(Caribbean_HadISSTAndRCP8.5_atsites)
rm(Caribbean_HadISSTAndRCP8.5_atsites_formatrix)
rm(Caribbean_SST_GISS_HistoRCP8.5_atsites_matrix)
rm(Caribbean_SST_HadISSTAndRCP4.5_atsites_formatrix)
rm(Caribbean_SST_HadISSTAndRCP4.5_atsites_matrix)
rm(Caribbean_SST_HadISSTAndRCP8.5_atsites)
rm(Caribbean_SST_HadISSTAndRCP8.5_atsites_formatrix, Caribbean_SST_HadISSTAndRCP8.5_atsites_formatrix, Caribbean_SST_HadISSTAndRCP8.5_atsites_formatrix)
rm(Caribbean_SST_HadISSTAndRCP8.5_atsites_matrix)
#determine Indonesia outline
CT_extent <- extent(c(80, 180, -30, 30))
CT_coarse_rcp45 <- crop(coarse_rcp45, CT_extent)
CT_coarse_rcp85 <- crop(coarse_rcp85, CT_extent)
CT_mean_OISST_ltm <- crop(mean_OISST_ltm, CT_extent)
CT_HadISST_sst <- crop(HadISST_sst, CT_extent)
mean_CT_coarse_rcp45_1982to2010 <- calc(subset(CT_coarse_rcp45,1584:1944), mean)
anoms_CT_coarse_rcp45_1850to2300 <- CT_coarse_rcp45 - mean_CT_coarse_rcp45_1982to2010
anoms_CT_coarse_rcp45_1850to2300_0.25 <- resample(anoms_CT_coarse_rcp45_1850to2300, CT_mean_OISST_ltm, method = 'bilinear')
Delta_CT_HisttoRCP4.5 <- CT_mean_OISST_ltm + anoms_CT_coarse_rcp45_1850to2300_0.25
mean_CT_coarse_rcp85_1982to2010 <- calc(subset(CT_coarse_rcp85,1584:1944), mean)
anoms_CT_coarse_rcp85_1850to2300 <- CT_coarse_rcp85 - mean_CT_coarse_rcp85_1982to2010
anoms_CT_coarse_rcp85_1850to2300_0.25 <- resample(anoms_CT_coarse_rcp85_1850to2300, CT_mean_OISST_ltm, method = 'bilinear')
Delta_CT_HisttoRCP8.5 <- CT_mean_OISST_ltm + anoms_CT_coarse_rcp85_1850to2300_0.25
mean_CT_HadISST_sst_1982to2018 <- calc(subset(CT_HadISST_sst, 1344:1779), mean)
anoms_CT_HadISST_sst <- CT_HadISST_sstAB - mean_CT_HadISST_sst_1982to2018
mean_CT_HadISST_sst_1982to2018 <- calc(subset(CT_HadISST_sst, 1344:1779), mean)
anoms_CT_HadISST_sst <- CT_HadISST_sst - mean_CT_HadISST_sst_1982to2018
anoms_CT_HadISST_sst_0.25 <- resample(anoms_CT_HadISST_sst, CT_mean_OISST_ltm, method = 'bilinear')
Delta_CT_HadISST_sst <- CT_mean_OISST_ltm + anoms_CT_HadISST_sst_0.25
plot(Delta_CT_HadISST_sst[[1]])
plot(cellStats(Delta_CT_HadISST_sst, stat = 'mean'))
#SWP Hist and RCP8.5
Delta_CT_coarse_RCP4.5_forbind <- dropLayer(Delta_CT_HisttoRCP4.5, 1:2019)
Delta_CT_HadISSTAndRCP4.5 <- stack(Delta_CT_HadISST_sst, Delta_CT_coarse_RCP4.5_forbind, value = TRUE)
#SWP Hist and RCP8.5
Delta_CT_coarse_RCP8.5_forbind <- dropLayer(Delta_CT_HisttoRCP8.5, 1:2019)
Delta_CT_HadISSTAndRCP8.5 <- stack(Delta_CT_HadISST_sst, Delta_CT_coarse_RCP8.5_forbind, value = TRUE)
#indonesia HadISST and RCP4.5
CT_SST_HadISSTAndRCP4.5_atsites <- data.frame(CT_coords, CT_reef_ID, extract(Delta_CT_HadISSTAndRCP4.5, indonesia_coords))
CT_SST_HadISSTAndRCP4.5_atsites_formatrix <- CT_SST_HadISSTAndRCP4.5_atsites[,-c(1,2)]
CT_SST_HadISSTAndRCP4.5_atsites_matrix <- as.matrix(CT_SST_HadISSTAndRCP4.5_atsites_formatrix)
CT_SST_HadISSTAndRCP4.5_atsites_matrix <- IfNAReplace(CT_SST_HadISSTAndRCP4.5_atsites_matrix)
#indonesia HadISST and RCP8.5
CT_SST_HadISSTAndRCP8.5_atsites <- data.frame(CT_coords, CT_reef_ID, extract(Delta_Indonesia_HadISSTAndRCP8.5, indonesia_coords))
#indonesia HadISST and RCP8.5
CT_SST_HadISSTAndRCP8.5_atsites <- data.frame(CT_coords, CT_reef_ID, extract(Delta_CT_HadISSTAndRCP8.5, indonesia_coords))
CT_SST_HadISSTAndRCP8.5_atsites_formatrix <- CT_SST_HadISSTAndRCP8.5_atsites[,-c(1,2)]
CT_SST_HadISSTAndRCP8.5_atsites_matrix <- as.matrix(CT_SST_HadISSTAndRCP8.5_atsites_formatrix)
CT_SST_HadISSTAndRCP8.5_atsites_matrix <- IfNAReplace(CT_SST_HadISSTAndRCP8.5_atsites_matrix)
write.csv(CT_SST_HadISSTAndRCP8.5_atsites_matrix, file = 'CT_HadISSTAndRCP8.5_atsites_matrix_INM.csv')
write.csv(CT_SST_GISS_HistoRCP4.5_atsites_matrix, file = 'CT_HadISSTAndRCP8.5_atsites_matrix_INM.csv')
write.csv(CT_SST_HadISSTAndRCP4.5_atsites_matrix, file = 'CT_HadISSTAndRCP8.5_atsites_matrix_INM.csv')
write.csv(CT_SST_HadISSTAndRCP8.5_atsites_matrix, file = 'CT_HadISSTAndRCP8.5_atsites_matrix_INM.csv')
write.csv(CT_SST_HadISSTAndRCP4.5_atsites_matrix, file = 'CT_HadISSTAndRCP8.5_atsites_matrix_INM.csv')
write.csv(CT_SST_HadISSTAndRCP8.5_atsites_matrix, file = 'CT_HadISSTAndRCP8.5_atsites_matrix_INM.csv')
write.csv(CT_SST_HadISSTAndRCP4.5_atsites_matrix, file = 'CT_HadISSTAndRCP4.5_atsites_matrix_INM.csv')
rm(CT_coarse_rcp45)
rm(CT_coarse_rcp85, CT_SST_HadISSTAndRCP4.5_atsites, CT_SST_HadISSTAndRCP4.5_atsites_formatrix)
rm(CT_SST_HadISSTAndRCP4.5_atsites_matrix, CT_SST_HadISSTAndRCP8.5_atsites, CT_SST_HadISSTAndRCP8.5_atsites_formatrix)
rm(CT_SST_HadISSTAndRCP8.5_atsites_matrix)
rm(Delta_CT_coarse_RCP4.5_forbind, Delta_CT_coarse_RCP8.5_forbind, Delta_CT_HadISSTAndRCP4.5, Delta_CT_HadISSTAndRCP8.5, Delta_CT_HisttoRCP4.5, Delta_CT_HisttoRCP8.5)
rm(anoms_Caribbean_coarse_rcp45_1850to2300, anoms_Caribbean_coarse_rcp45_1850to2300_0.25, anoms_Caribbean_coarse_rcp85_1850to2300, anoms_Caribbean_coarse_rcp85_1850to2300_0.25, anoms_Caribbean_HadISST_sst, anoms_Caribbean_HadISST_sst_0.25, anoms_CT_coarse_rcp45_1850to2300, anoms_CT_coarse_rcp45_1850to2300_0.25, anoms_CT_coarse_rcp85_1850to2300, anoms_CT_coarse_rcp85_1850to2300_0.25, anoms_CT_HadISST_sst, anoms_CT_HadISST_sst_0.25)
rcp45 <- brick(file.choose(""), values = TRUE, varname = 'tos')
rcp45 <- points(file.choose(""), values = TRUE, varname = 'tos')
rcp45 <- points(file.choose(""), values = TRUE, varname = 'tos')
help("raster-package")
rcp45 <- stack(file.choose(""), values = TRUE, varname = 'tos')
getwd()
setwd("~/Documents/GitHub/Regional_Coral")
write.csv(CT_coords, file = 'CT_coords.csv')
write.csv(caribbean_coords, file = 'aribbean_coords.csv')
write.csv(caribbean_coords, file = 'Caribbean_coords.csv')
write.csv(swp_coords, file = 'SWP_coords.csv')
coarse_rcp45 <- brick(file.choose(""), values = TRUE, varname = 'tos')
coarse_rcp85 <- brick(file.choose(""), values = TRUE, varname = "tos")
OISST_ltm <- brick(file.choose(""), values = TRUE, varname = "sst")
Caribbean_extent <- extent(c(260, 310, 0, 50))
Caribbean_coarse_rcp45 <- crop(coarse_rcp45, Caribbean_extent)
Caribbean_coarse_rcp85 <- crop(coarse_rcp85, Caribbean_extent)
Caribbean_mean_OISST_ltm <- crop(mean_OISST_ltm, Caribbean_extent)
OISST_ltm <- brick(file.choose(""), values = TRUE, varname = "sst")
mean_OISST_ltm <- calc(OISST_ltm, mean)
Caribbean_mean_OISST_ltm <- crop(mean_OISST_ltm, Caribbean_extent)
mean_Caribbean_coarse_rcp45_1982to2010 <- calc(subset(Caribbean_coarse_rcp45,1584:1944), mean)
anoms_Caribbean_coarse_rcp45_1850to2300 <- Caribbean_coarse_rcp45 - mean_Caribbean_coarse_rcp45_1982to2010
anoms_Caribbean_coarse_rcp45_1850to2300_0.25 <- resample(anoms_Caribbean_coarse_rcp45_1850to2300, Caribbean_mean_OISST_ltm, method = 'bilinear')
Delta_Caribbean_HisttoRCP4.5 <- Caribbean_mean_OISST_ltm + anoms_Caribbean_coarse_rcp45_1850to2300_0.25
mean_Caribbean_coarse_rcp85_1982to2010 <- calc(subset(Caribbean_coarse_rcp85,1584:1944), mean)
anoms_Caribbean_coarse_rcp85_1850to2300 <- Caribbean_coarse_rcp85 - mean_Caribbean_coarse_rcp85_1982to2010
anoms_Caribbean_coarse_rcp85_1850to2300_0.25 <- resample(anoms_Caribbean_coarse_rcp85_1850to2300, Caribbean_mean_OISST_ltm, method = 'bilinear')
Delta_Caribbean_HisttoRCP8.5 <- Caribbean_mean_OISST_ltm + anoms_Caribbean_coarse_rcp85_1850to2300_0.25
mean_Caribbean_HadISST_sst_1982to2018 <- calc(subset(Caribbean_HadISST_sst_shifted, 1344:1779), mean)
anoms_Caribbean_HadISST_sst <- Caribbean_HadISST_sst_shifted - mean_Caribbean_HadISST_sst_1982to2018
anoms_Caribbean_HadISST_sst_0.25 <- resample(anoms_Caribbean_HadISST_sst, Caribbean_mean_OISST_ltm, method = 'bilinear')
Delta_Caribbean_HadISST_sst <- Caribbean_mean_OISST_ltm + anoms_Caribbean_HadISST_sst_0.25
plot(Delta_Caribbean_HadISST_sst[[1]])
plot(cellStats(Delta_Caribbean_HadISST_sst, stat = 'mean'))
#SWP Hist and RCP8.5
Delta_Caribbean_coarse_RCP4.5_forbind <- dropLayer(Delta_Caribbean_HisttoRCP4.5, 1:2019)
Delta_Caribbean_HadISSTAndRCP4.5 <- stack(Delta_Caribbean_HadISST_sst, Delta_Caribbean_coarse_RCP4.5_forbind, value = TRUE)
#SWP Hist and RCP8.5
Delta_Caribbean_coarse_RCP8.5_forbind <- dropLayer(Delta_Caribbean_HisttoRCP8.5, 1:2019)
Delta_Caribbean_HadISSTAndRCP8.5 <- stack(Delta_Caribbean_HadISST_sst, Delta_Caribbean_coarse_RCP8.5_forbind, value = TRUE)
plot(cellStats(Delta_Caribbean_HisttoRCP4.5, stat = 'mean'))
rm(anoms_Caribbean_coarse_rcp45_1850to2300, anoms_Caribbean_coarse_rcp45_1850to2300_0.25, anoms_Caribbean_coarse_rcp85_1850to2300, anoms_Caribbean_coarse_rcp85_1850to2300_0.25, anoms_Caribbean_HadISST_sst, anoms_Caribbean_HadISST_sst_0.25)
#plot(cellStats(Delta_Caribbean_HisttoRCP4.5, stat = 'mean'))
#plot(cellStats(Delta_Caribbean_coarse_RCP4.5_forbind, stat = 'mean'))
plot(cellStats(Delta_Caribbean_HadISSTAndRCP4.5, stat = 'mean'))
plot(cellStats(Delta_Caribbean_HadISSTAndRCP8.5, stat = 'mean'))
xy <- caribbean_coords[,c(1,2)]
spdf <- SpatialPointsDataFrame(coords = xy, data = caribbean_coords,
proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
Delta_Caribbean_HadISSTAndRCP4.5 <- setExtent(Delta_Caribbean_HadISSTAndRCP4.5, c(-100, -50, 0, 50))
Caribbean_HadISSTAndRCP4.5_atsites <- data.frame(caribbean_coords, caribbean_reef_ID, extract(Delta_Caribbean_HadISSTAndRCP4.5, spdf))
Caribbean_HadISSTAndRCP4.5_atsites_formatrix <- Caribbean_HadISSTAndRCP4.5_atsites[,-c(1,2)]
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- as.matrix(Caribbean_HadISSTAndRCP4.5_atsites_formatrix)
Caribbean_HadISSTAndRCP4.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP4.5_atsites_matrix)
Delta_Caribbean_HadISSTAndRCP8.5 <- setExtent(Delta_Caribbean_HadISSTAndRCP8.5, c(-100, -50, 0, 50))
Caribbean_HadISSTAndRCP8.5_atsites <- data.frame(caribbean_coords, caribbean_reef_ID, extract(Delta_Caribbean_HadISSTAndRCP8.5, spdf))
Caribbean_HadISSTAndRCP8.5_atsites_formatrix <- Caribbean_HadISSTAndRCP8.5_atsites[,-c(1,2)]
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- as.matrix(Caribbean_HadISSTAndRCP8.5_atsites_formatrix)
Caribbean_HadISSTAndRCP8.5_atsites_matrix <- IfNAReplace(Caribbean_HadISSTAndRCP8.5_atsites_matrix)
plot(Caribbean_HadISSTAndRCP4.5_atsites_matrix[1,-c(1)])
plot(Caribbean_HadISSTAndRCP8.5_atsites_matrix[1,-c(1)])
write.csv(Caribbean_HadISSTAndRCP8.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP8.5_atsites_matrix_GISS.csv')
write.csv(Caribbean_HadISSTAndRCP4.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP4.5_atsites_matrix_GISS.csv')
rm(Delta_Caribbean_coarse_RCP4.5_forbind, Delta_Caribbean_coarse_RCP8.5_forbind, Delta_Caribbean_HadISST_sst, Delta_Caribbean_HadISSTAndRCP4.5, Delta_Caribbean_HadISSTAndRCP8.5, Delta_Caribbean_HisttoRCP4.5, Delta_Caribbean_HisttoRCP8.5, Delta_CT_HadISST_sst)
getwd()
write.csv(Caribbean_HadISSTAndRCP8.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP8.5_atsites_matrix_GISS.csv')
write.csv(Caribbean_HadISSTAndRCP4.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP4.5_atsites_matrix_GISS.csv')
setwd("~/Documents/GitHub/Regional_Coral/Caribbean")
write.csv(Caribbean_HadISSTAndRCP8.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP8.5_atsites_matrix_GISS.csv')
write.csv(Caribbean_HadISSTAndRCP4.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP4.5_atsites_matrix_GISS.csv')
write.csv(Caribbean_HadISSTAndRCP8.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP8.5_atsites_matrix_GISS.csv')
write.csv(Caribbean_HadISSTAndRCP4.5_atsites_matrix, file = 'Caribbean_HadISSTandRCP4.5_atsites_matrix_GISS.csv')
getwd()
rm(OISST_ltm)
rm(sst_HadISST)
rm(CT_HadISST_sst)
rm(coarse_rcp45, coarse_rcp85)
rm(Caribbean_coarse_rcp45)
rm(Caribbean_coarse_rcp85)
rm(Caribbean_HadISSTAndRCP4.5_atsites, Caribbean_HadISSTAndRCP4.5_atsites_formatrix, Caribbean_HadISSTAndRCP4.5_atsites_matrix)
rm(Caribbean_HadISSTAndRCP8.5_atsites)
rm(Caribbean_HadISSTAndRCP8.5_atsites_formatrix)
rm(Caribbean_HadISST_sst_shifted)
rm(Caribbean_HadISSTAndRCP8.5_atsites_matrix)
rm(Caribbean_mean_OISST_ltm)
